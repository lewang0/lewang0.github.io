<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        Posts ::
        小碼哥
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content=""
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://lewang.dev/posts/" />







<link rel="stylesheet" href="/css/style.css" />

<link rel="stylesheet" href="https://lewang.dev/style.css" />


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lewang.dev/img/apple-touch-icon-144-precomposed.png" />
<link rel="shortcut icon" href="https://lewang.dev/img/favicon.png" />


<link href="/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://lewang.dev/lewangdev-cover.png"/>

<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content="我是小码哥，时常会分享一些关于创业/产品/Web开发/效率/DevOps/玩等方面的东西"/>



<meta property="og:title" content="Posts" />
<meta property="og:description" content="我是小码哥，时常会分享一些关于创业/产品/Web开发/效率/DevOps/玩等方面的东西" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://lewang.dev/posts/" /><meta property="og:image" content="https://lewang.dev/lewangdev-cover.png"/>



<link rel="alternate" type="application/rss+xml" href="/posts/index.xml" title="小碼哥" />



  </head>
  <body class="auto-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="https://lewang.dev"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >小碼哥</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/tags/">Tags</a></li>
        
      
        
          <li><a href="/about/">About</a></li>
        
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/tags/">Tags</a></li>
      
    
      
        <li><a href="/about/">About</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="posts">
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2023-03-20-thinking-daily-1/">日常吐槽</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2023-03-20
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E8%82%B2%E5%84%BF/">#育儿</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E5%90%90%E6%A7%BD/">#吐槽</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2023-03-20-thinking-daily-1/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2022-06-06-save-your-kindle-ebooks/">Kindle 中国停止运营，一键下载已购买的电子书</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2022-06-06
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/python/">#Python</a>&nbsp;
            
              <a href="https://lewang.dev/tags/kindle/">#Kindle</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              前几天亚马逊宣告 Kindle 中国电子书店运营进行调整，通知标题写得比较委婉，其实就是亚马逊电子书即将退出中国市场，到时候我们购买的国行版 Kindle 将不能购买新电子书，也不能下载已经购买的电子书了。
如果购买的电子书比较多，手动一本一本的去下载是挺费时间的，我来分享一下我是如何使用 Python 一键下载所有电子书的。
安装 Python # 用 Chrome 浏览器打开 https://python.org，下载最新版本的 Python 3.10.4
下载好然后运行 python-3.10.4-amd64.exe, 选择第一个选项，一定要记得勾选添加到 PATH，否则在命令行中执行 python 时会报错。
准备 Python 一键下载脚本 # 用 Chrome 浏览器打开 https://github.com/yihong0618/Kindle_download_helper，下载 ZIP 包后并且解压:
使用 Python 一键下载脚本 # 进入解压后的目录，点击鼠标右键打开一个命令行窗口
打开的命令行窗口是这样的：
接下来准备 python 的虚拟环境，在命令行窗口输入：
python -m venv venv 创建好虚拟环境之后，再激活虚拟环境，在命令行窗口输入：
.\venv\Scripts\activate.bat 安装 Python 脚本的依赖库，在命令行窗口输入：
pip install -r requirements.txt 至此，一键下载脚本准备就绪，在命令行窗口输入：
python kindle.py 这样看到了脚本的帮助提示：
接下来我们准备脚本需要的 cookie 和 csrf_token, 这两个值都需要通过 Chrome 浏览器获取。
获取 cookie 和 csrf_token # 首先使用浏览器登录亚马逊账号，
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2022-06-06-save-your-kindle-ebooks/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2022-05-27-store-files-as-youtube-videos/">写个程序把油管 YouTube 变成无限容量的网盘</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2022-05-27
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/python/">#Python</a>&nbsp;
            
              <a href="https://lewang.dev/tags/youtube/">#YouTube</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              前几天刷新闻的时候，看到了一个代码仓库 YouTubeDrive 的介绍，他的作者在多年前用 Wolfram 语言（也就是 Mathematica） 编写了一段代码，可以将油管变成一个无限容量的大网盘，看完介绍之后我脑子里直接蹦出无数个“卧槽”，心里顿生“这样也行”的膜拜之情，不禁提问：这个是薅羊毛的最高境界吗？
说起 Wolfram 语言和 Mathematica，不得不提一下，它是我学习的第一个编程语言（汇编是第二个）。多年前我是在学校机房学的，当时只用它画画数学公式的图，今天看着 YouTubeDrive 的实现，才了解到 Wolfram 还可以这样用。
首先，和原作者一样，我也不提倡这样把 YouTube 当成一个无限容量的网盘使用，相同的道理，我也不提倡在国内把 B 站或者任意视频平台当做位无限容量的网盘来用。
昨天在看完 YouTubeDrive 源码之后，想着要不我也用 Python 实现一个，正好傍晚溜娃的时候，啥也不能干，就边走边想，我用 Python 应该怎么来实现一个？ 在坐着等娃的时候，就用手机查下资料，大概了解了一下 numpy 和 opencv 的使用，晚上吃过晚饭就开始写了，很快也实现了一个可以工作的 Python 版的。
我觉得这个想法还是挺有意思的，虽然不太靠谱，但是真的好玩。不想去读 Wolfram 源码的朋友可以看看我接下来的分析，看看是如何把文件变成 YouTube 视频的进行存储的。
磁盘上的文件是什么 # 在我们的计算机（无论电脑还是手机都是计算机）磁盘里，存放了很多很多的文件，例如图片，文档，视频等等，每种文件都有自己的类型，或者叫格式，一般我们都会给文件添加一个后缀名展示文件的类型，但是对于电脑而言，无论是什么文件，它都只是由比特（bit） 0 和 1 组成的数据。
例如这张图片：
用 vim 执行命令 :%!xxd，打开是这样的：
图片文件的头 4 个字节是 ffd8（其实 ffd8 说明了这个是 JPEG 格式的文件），ffd8 是 16 进制的表示法，比 2 进制看起来更清晰。
在计算机里，用 8 个 bit 表示一个 byte，即 1 个字节有 8 位，一个字节需要用 2 个 16 进制数来表示，例如：ffd8 是 2 个字节。
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2022-05-27-store-files-as-youtube-videos/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2022-05-21-replace-strings-in-all-files/">grep，xargs 和 sed 的一次日常使用</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2022-05-21
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
              <a href="https://lewang.dev/tags/grep/">#grep</a>&nbsp;
            
              <a href="https://lewang.dev/tags/sed/">#sed</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              趁着周末空隙把自己年久失修博客整理了一下，用到了 grep，xargs 和 sed 命令，使用这 3 个命令组合批量替换了所有 Markdown 文件中的图片链接。
我的博客从我的学生时代就开始了，不断折腾自己的博客，所以学会了 HTML/CSS/JS，下次和大家分享一下我的博客旅程。
这里不详细讲解这 3 个命令的使用，这 3 个命令的使用可以写出来厚厚的一本书。如果希望详细的了解这些命令，可以在 Linux 的终端下输入这样的命令查看文档，例如查看 grep 如何使用：
man grep man 命令的常用操作:
退出: 按 q 键 查找：按 / 后输入查找关键字 下一页: 按 ctrl + d 或者 ctrl + f，tips: 这里的 d 大概是 down，f 大概是 forward 上一页: 按 ctrl + u 或者 ctrl + b，tips: 这里的 d 大概是 up，b 大概是 backward 查看其它命令的手册也是类似的。
我博客的问题 # 我的博客是用 hugo 构建的，所有的文章都放在 post 下面的目录里，图片则需要放在 static 的 images 下面，这样在用 vscode 写博客 Markdown 的时候无法在预览里面看到图片。于是我在 hugo 项目的根目录下添加了的一个 images 的符号链接到 static 目录下的 images， 才能解决图片预览的问题。
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2022-05-21-replace-strings-in-all-files/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2022-05-20-format-json-in-command-line-copy/">命令行格式化 JSON</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2022-05-20
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/python/">#Python</a>&nbsp;
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              今天要改 Docker 的两个配置 hostconfig.json 和 config.v2.json，打开一看，这个文件是单行的，在编辑器里面显示这是这样的：
代码都堆在一起，用 vim 格式化也没啥效果，编辑起来不是很方便。
Python 自带模块格式化 JSON # 格式化 JSON 文件有很多方法，我最常用的就是 Python 自带的 json.tool 这个模块，只要安装了 Python 的电脑，都可以直接使用，这样就可以了：
python -m json.tool hostconfig.json &gt; hostconfig-formatted.json 格式化以后再打开看一看：
这样编辑文件就方便多了。
与管道符一起使用 # 前面的例子我们还可以使用管道符(|)来实现，例如:
cat hostconfig.json | python -m json.tool &gt; hostconfig-formatted.json 从 RESTful 接口直接获取数据并且格式化:
curl -s https://api.github.com/users/lewangdev | python -m json.tool 其它本地格式化工具 # DevToysMac: MacOS 版的 DevToys or Windows，我是用 Windows 11 时候看到这个软件的，于是顺手搜了一下 MacOS 版的，也挺好用的。 jq: 除了像 sed 一样的处理 JSON 以外，还能把输出的 JSON 变成彩色的。 curl &#39;https://api.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2022-05-20-format-json-in-command-line-copy/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2022-05-16-cndevnet-intro/">如何打造国内开发所需要的网络</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2022-05-16
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/debian/">#Debian</a>&nbsp;
            
              <a href="https://lewang.dev/tags/cndevnet/">#cndevnet</a>&nbsp;
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              本项目正在调整，请稍等再使用
一个对国内开发者可能有点用的网络工具，cndevnet 帮助开发者，尤其是初学者不用再费心折腾 pip/npm/golang/flutter/android/blockchain 等等无法访问的问题。
背景 # 由于某些原因，国内开发者需要的不少技术站点或者镜像源都无法直接访问，这使得在开发者在日常工作中会消耗额外的时间，去设置各种代理或者寻找国内的可替代的镜像源来使用。
在开源软件的世界里，几乎所有的知名项目，原本只要把代码 clone 回来，不需要做额外任何配置，只需要按照它的说明就可以直接编译源码。但由于网络的原因，在国内甚至连开源软件的源码都不太方便直接下载，一些原本只需要从 GitHub 拉下来代码就可以直接编译成功的项目，在国内也是连编译都编译不过。
国内开发者群体是非常庞大的，所以我看到了很多知名的开源项目为中国用户在 README.md 文档或是页面的显著位置都增加了中文提示，去引导国内开发者去使用国内的镜像。
Flutter
powerlevel10k
但是，我想这种做法应该不属于 i18n，因为我很少看到有引导日本的开发者去用日本的镜像，或者引导德国的开发者去用德国的镜像，这看似解决了访问慢或者无法访问的问题，但其实是加剧了国内开发者与全球互联网的割裂，在开发者的世界里面，也形成了国内和国外两个网络。
给系统或软件单独设置代理，或者寻找国内的可替代的镜像源我都觉得不是一个好方案，因为这样在国内的你总会遇到各种各样的国外开发者就不会遇到的问题，最好还是能够拥有一个与国外开发者“用起来”好像是一样的网络环境。
cndevnet 就是为了解决这个问题而创建的，希望能帮助到和我一样遇到相同问题的国内开发者。
从 Linux 开始 # cndevnet 可以在 Linux 环境下搭建一个专为初学开发者设置的开发网络，搭配使用 vscode 进行远程开发是一种不错的体验，适合学习 python/golang 等。
Linux 环境可以是在国内云平台上的一台云主机，也可以是运行在本地虚拟机里面的主机，或者是局域网中的一台 Linux 主机。
Debian 是一个非常棒的 Linux 发行版，推荐希望学习 Linux 的初学者使用。如果希望使用带有图形界面的 Linux 系统，Ubuntu 也是一个非常好的选择。
cndevnet 使用了以下软件和服务 # Debian：目前支持的 Linux 系统 Docker: 用于运行 gost 和 smartdns 服务 gost: 用于建立 WSS(Websocket over TLS) 服务 smartdns： 用于解决 DNS 污染 dnsmasq-china-list： 国内域名 Cloudflare IP Range: Cloudflare 的 IP 范围 Cloudflare: Cloudflare 的 WSS 代理服务 Oracle Cloud: Oracle Cloud 的云主机 cndevnet 原理 # cndevnet 通过 iptables 等工具和数据实现了系统的透明代理，由于是系统级的透明代理，所以在启用了 cndevnet 的 Linux 系统上，是不需要为系统或者各类开发工具或者服务单独设置代理的。
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2022-05-16-cndevnet-intro/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2020-12-02-add-gost-plugin-for-shadowsocks-ng/">写了一个 ShadowsocksX-NG 的 gost 插件</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2020-12-02
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 2 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/gost/">#gost</a>&nbsp;
            
              <a href="https://lewang.dev/tags/shadowsocks/">#shadowsocks</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              gost 是一个非常有用的网络工具，可以在 ShadowsocksX-NG 中安装 gost 插件，方便在 ShadowsocksX-NG 中使用 gost。
原由 # 自从查资料上网工具换成 gost 之后，由于 MacOS 上没有 gost 专用的智能代理（也就是该翻的时候翻，不用翻的时候不翻）桌面客户端，所以需要用 gost 在本地把 wss 代理转成 ss 后再继续使用 ShadowsocksX-NG。 虽然可以用 launchctl 启动一个 gost 后台服务，但是用起来还是不太方便。
看了下 ShadowsocksX-NG 是如何工作的： ShadowsocksX-NG 会在本地启动 ss-local 进程跑一个 socks5 服务，而且 ShadowsocksX-NG 实现智能代理的逻辑与 ss-local 并没有太多的关系，所以只要在想办法本地能提供一个 socks5 服务就够了。
于是写了以下脚本替换了 ShadowsocksX-NG 安装目录下的 ss-local(替换之前要备份一下这个文件)
#!/bin/sh - #/opt/gost/gost -L=sock5://:1086 -F=wss://username:password@1.1.1.1:443 # Use gost.json #{ # &#34;Retries&#34;: 3, # &#34;Debug&#34;: false, # &#34;ServeNodes&#34;: [ # &#34;socks5://127.0.0.1:1086&#34; # ], # &#34;ChainNodes&#34;: [ # &#34;wss://username:password@1.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2020-12-02-add-gost-plugin-for-shadowsocks-ng/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2020-11-27-go-through-the-system-firewall/">机房不能访问互联网，轻松搞定系统部署</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2020-11-27
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 5 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E9%83%A8%E7%BD%B2/">#部署</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/">#网络拓扑</a>&nbsp;
            
              <a href="https://lewang.dev/tags/iot/">#IoT</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              创业这段时间以来，我们的 IoT 系统已经在不少客户的机房做了私有化部署，客户大多都是机加工厂、商业大楼、医院和大学实验室等，客户的机房都有一个相同的特点：私有云，与外网隔离，不能访问互联网。或者更为准确的说，是我们部署的服务器不能访问互联网，在没有互联网访问权限的情况下，系统的包管理工具(yum/apt/docker)都无法使用了，在这种情况下进行系统部署安装，费时费力，而且无法进行远程部署维护，也大大增加了项目的实施成本。
在最近的一个客户项目的实施过程中，看到客户的一些其他供应商在系统部署过程中非常艰难，甚至是 CentOS 系统初始化和 Docker 的安装就花掉了两个礼拜的人力，不排除一些供应商这样折腾会给他的客户留下工作敬业钱花的值的好印象，但对于我们这样的小创业公司来说，这样的时间浪费和低效是无法承担的成本，因为来实操部署的人就是公司老板本人了，我也不想出差在客户这里待上两个礼拜。
在工作完成之后，想想可以把解决问题的方法记录一下，也许能给遇到相同问题的同行一些启发和帮助。好了，废话不多说，接下来我们就来解决这个无外网的部署问题，顺便再解决一下远程维护的问题。
一、面临的问题 # 在部署和维护一个私有化企业内部使用且无互联网访问的系统中，可能会面临以下问题:
机房服务器无法访问 Internet 可通过接入企业内网来访问服务器，而从服务器无法直连办公室网络，即机房和办公室在不同的网段 无互联网访问权限的情况下，无法直接使用系统的配置工具，如 yum/apt/docker 等，配置系统和部署服务费时费力 无法远程进行维护 客户内网拓扑示意图，此处省略了防火墙，简化拓扑图的复杂度，如下:
网络拓扑图说明:
机房和办公室不在一个网段 机房网段假设为 172.22.0.0/16，办公室内网 WiFi 的网段为 192.168.137.0/24 机房服务器之间是互通的，办公室可以 ping 通机房服务器，在机房服务器上无法 ping 通办公室部署控制主机，这里假设办公室网络作为一个 NAT 放在上层交换机后面 内网没有互联网访问权限，包括机房服务器和办公室内网 WiFI 二、解决问题的方法 # 既然是由于机房服务器没有互联网访问权限，不能联网下载安装包，那就想办法让机房服务器可以连接互联网或者搭建内网的软件包镜像服务，于是想到一些方法来达到目的:
告知客户问题，申请开通互联网访问权限，可以限定为指定的网址和协议(HTTP/HTTPS)，需要远程维护的化，还需要申请可以连接到服务器的 VPN。这个方法在需要客户的进行审批，可能时间比较长。我们的客户中有不少都没有自建 VPN，或这不方便给我们开通 VPN，另外也无法开通需要我们部署的服务器的互联网访问权限，所以不能使用这个方法
在客户机房放置可以通过 4G 上网的堡垒机，堡垒机接入客户机房网络。在客户机房放一个堡垒机，虽然说是堡垒机，但可能客户那边的机房管理也还是不容许放置这样的机器的，所以也不能使用这个方法
搭建 yum(CentOS)/apt(Debian/Ubuntu)/docker 的内网镜像服务，搭建内网镜像服务可能就是一个比较艰巨的任务，难以接受给自己又添加了一个艰难的任务，此方法也作罢
通过在办公室网里放置部署控制机，同时连接内网和 4G 路由器提供的外网(互联网)，在部署控制机上搭建 SDWAN 或者 HTTP 代理，yum/apt/docker 都支持 HTTP 代理，这样修改系统配置之后，就可以通过代理安装部署服务，这个方法比较简单，而且几乎不需要客户的参与就可以完成。不过也有一些前置条件，例如:
办公室中主机可以接入客户网络
客户服务器允许办公室网络中主机通过 TCP 或者 UDP 访问其任意或者指定的端口
客户办公室的 4G 网络信号要足够好，这样可以提供更好的外网速度
拥有服务器的 root 管理员权限(需要安装软件和修改系统配置)
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2020-11-27-go-through-the-system-firewall/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2020-02-22-hello-gradle-1/">大象（Gradle）的故事：一见如故</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2020-02-22
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 3 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/gradle/">#Gradle</a>&nbsp;
            
              <a href="https://lewang.dev/tags/java/">#Java</a>&nbsp;
            
              <a href="https://lewang.dev/tags/groovy/">#Groovy</a>&nbsp;
            
              <a href="https://lewang.dev/tags/kotlin/">#Kotlin</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              小码哥：“与大象（Gradle）一见如故？你就是 Gradle？”
大象：“对，我就是那个用来构建 Java 项目的 Gradle 大象。 ”
小码哥：“我好像天天都在用你啊。看，我的项目都是用你构建的。”
大象：“但你不一定真的认识我，你每次修改点构建代码时是不是都要问下谷哥哥（Google）或溢栈哥哥（StackOverflow）？”
小码哥：“额。。。”
大象：“我是你的老朋友了，不要天天如初见哦，咱们得多聊聊，我爸妈给我写了传记（文档），估计你也懒得细看，不如我给你做个自我介绍吧。”
小码哥：“👌ok”
大象：“你有用 InteliJ IDEA 吗？ ”
小码哥：“对，用的社区版。”
大象：“那我就用 InteliJ IDEA CE 版来给你介绍自己”。
你好，我是 Gradle！ # Gradle 是一个用来自动化构建项目的的工具，可以用来构建你常用的 Java、Kotlin 等 JVM 语言开发的项目。我的配置文件可以使用 Gvoovy 或者 Kotlin 来编写，不像隔壁前辈 Maven 那样，要写一大段 XML，你可以很开心的像写代码一样来调整我的配置。
其实我就是你的代码自动化产线，产线有几个工序（Task），你负责喂我代码，我负责打包（Jar/War/JavaDoc/Test）。是不是觉得与科幻片里面的工厂很像？
创建项目 # 请打开你的 InteliJ IDEA CE，使用 idea 可以很方便的创建一个由我构建的项目(File &gt; New &gt; Project&hellip;)。
这里在对话框的左边栏选择 Gradle，右边选择 Java 项目。
输入好项目名之后点击 Finish 就可以啦。
探索项目 # idea 帮我们创建了一个 Java 项目，浏览项目很容易发现两个以 gradle 为结尾的文件： build.gradle 和 settings.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2020-02-22-hello-gradle-1/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2019-11-02-fangta-paintings/">游方塔园</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2019-11-02
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E8%82%B2%E5%84%BF/">#育儿</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E7%BB%98%E7%94%BB/">#绘画</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2019-11-02-fangta-paintings/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2019-10-30-wireguard-go-setup/">WireGuard 使用简介</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2019-10-30
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 2 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/wireguard/">#WireGuard</a>&nbsp;
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
              <a href="https://lewang.dev/tags/vpn/">#VPN</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              背景 # 搭建 VPN 方便连接无公网 IP 云主机进行开发，WireGuard 配置比 OpenVPN 要简单很多，WireGuard 是通过 Linux 内核模块的方式实现的，这样性能最好，但是只能用在 Linux 系统上。本文使用的 wireguard-go， 则是使用 Golang 实现的 WireGuard 协议，属于用户空间(User Space)的实现，性能没有内核模块方式好，但好处就是跨平台且更简单易用。
VPN 的用处非常的多，不像 frp 之类的端口穿透应用，它是直接建立虚拟的网络，网络中的每个客户端也都可以拥有自己独立的 IP，于是测试调试就没有了端口的限制，非常的方便。
除了方便安全连接云服务器，还可以通过 VPN 搭建工业设备的远程部署和维护的解决方案。
编译 wireguard-go # # 使用 GitHub 的源码镜像，速度会快一些 git clone git@github.com:wireguard/wireguard-go.git # 在 MacOS 下交叉编译 CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -v -o &#34;wireguard-go&#34; # Linux 环境下直接编译 go build -v -o &#34;wireguard-go&#34; cp wireguard-go /usr/sbin/ 编译 WireGuard tools # git clone git@github.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2019-10-30-wireguard-go-setup/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2019-10-13-sons-paintings/">小糍粑的画</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2019-10-13
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E8%82%B2%E5%84%BF/">#育儿</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E7%BB%98%E7%94%BB/">#绘画</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2019-10-13-sons-paintings/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2019-09-19-rpi-log-config/">树莓派系统日志配置</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2019-09-19
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
              <a href="https://lewang.dev/tags/raspberry/">#Raspberry</a>&nbsp;
            
              <a href="https://lewang.dev/tags/raspbian/">#Raspbian</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              背景 # 树莓派 raspbian 系统日志默认的配置会导致日志过大而占用太多的存储空间，并且频繁写日志也可能减短 EMMC 和 SD 卡的寿命，需要重新配置来满足项目的需求。
日志位置 # /var/log /var/log/syslog /var/log/daemon.log /var/log/mail.info /var/log/mail.warn /var/log/mail.err /var/log/mail.log /var/log/kern.log /var/log/auth.log /var/log/user.log /var/log/lpr.log /var/log/cron.log /var/log/debug /var/log/messages 配置 rsyslog 与 logrotate # rsyslog 的配置文件为 /etc/rsyslog.conf, 找到其中 RULES 段
############### #### RULES #### ############### # # First some standard log files. Log by facility. # auth,authpriv.* /var/log/auth.log *.*;auth,authpriv.none -/var/log/syslog #cron.* /var/log/cron.log #daemon.* -/var/log/daemon.log kern.* -/var/log/kern.log lpr.* -/var/log/lpr.log mail.* -/var/log/mail.log user.* -/var/log/user.log 将其中 daemon.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2019-09-19-rpi-log-config/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2019-07-16-change-uid-gid-in-linux/">如何修改 Linux 用户的 UID 和组的 GID</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2019-07-16
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              问题 # 在使用 Docker 或者 NFS 的时候，需要文件系统挂在到不同的系统中拥有正确的读写权限，需要指定文件所属用户和组的 uid 和 gid。在创建用户和组的时候，系统会自动分配对应的值，这导致在不同的系统中很容易造成 uid 和 gid 不一样而造成读写权限混乱。
例如在系统 A 中，用户 git 的 uid 和组 git 的gid 如下:
[sysops@cn-bj-aliyun-3 ~]$ id git uid=1001(git) gid=1001(git) groups=1001(git) 而系统 B 中的值如下:
[sysops@cn-bj-aliyun-3 ~]$ id git uid=998(git) gid=998(git) groups=998(git) 我们在系统 A 以 git 用户创建目录或者文件:
[git@cn-bj-aliyun-3 data]$ ls -lh total 60K -rw-r--r-- 1 git git 100 Jul 5 23:22 file1 -rw-r--r-- 1 git git 400 Dec 18 2018 file2 -rw-r--r-- 1 git git 349 Dec 18 2018 file3 将这个目录挂在到 B 系统中时，将会出现这种情况:
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2019-07-16-change-uid-gid-in-linux/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2019-05-29-centos7-pyenv-install-python-3/">CentOS 7 上使用 pyenv 安装 Python 3.7.3</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2019-05-29
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/python/">#Python</a>&nbsp;
            
              <a href="https://lewang.dev/tags/pyenv/">#Pyenv</a>&nbsp;
            
              <a href="https://lewang.dev/tags/ssh/">#SSH</a>&nbsp;
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              概要 # 本文记录了在 CentOS 7.6 系统上通过 pyenv 安装 Python 3.7.3 的过程。
环境 # CentOS Linux release 7.6.1810 (Core) Kernel 3 3.10.0-957.el7.x86_64 Pyenv 1.2.11 安装 pyenv # $ curl https://pyenv.run | bash 然后根据提示把以下内容放到 ~/.bashrc 文件末尾
# Load pyenv automatically by adding # the following to ~/.bashrc: export PATH=&#34;/root/.pyenv/bin:$PATH&#34; eval &#34;$(pyenv init -)&#34; eval &#34;$(pyenv virtualenv-init -)&#34; 安装 Python 3.7.3 # 准备
$ sudo yum -y install xz bzip2 bzip2-devel sqlite-devel gcc openssl-devel readline-devel zlib-devel libffi-devel 安装
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2019-05-29-centos7-pyenv-install-python-3/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2019-03-06-keynotes-of-new-java/">Java 进阶要点</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2019-03-06
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/java/">#Java</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              自己学习 Java 和用 Java 过程中的理解和备忘的知识点。
JDK 11 # Oracle 不在免费提供 LTS 版本了，包括 JDK 8 ZGC, 可伸缩的、低延迟的垃圾收集器，STW 时间不超过 10ms Nashorn 标记为 Deprecate 了 JDK 9 # module try-catch 简化 _ 为保留关键字 var 将在 JDK 10 中作为关键字, 作为本地变量类型推断关键字 字符串相关，主要是 Compact String, 用 byte[] 替换了 char[], char 在 Java 中占两个字节 G1 作为默认垃圾回收器 JVM # 启动 JVM 相关的命令行参数 G1 垃圾回收器 内存 # JVM(Hotspot) 内存结构 制造各种 OutOfMemery 和 StackOverflow 各种 JVM 相关工具(jstat/jmap/jstack/jps 等) 解决 FullGC 的问题 引用：WeakRefrence/PhantomReference/SoftRefrence/FinalRefrence 等 ClassLoader/URLClassLoader Spring Boot 的 ClassLoader 自定义 ClassLoader 多线程和并发 # JVM 的线程模型 1:1 协程 创建线程的方法 线程同步 synchronzied/对象锁/类锁/锁方法/锁锁代码块 线程池 锁相关（Lock 接口和实现类） Condition volatile ThreadLocal 用途和实现 并发（CAS/乐观锁/无锁/无等待/无阻塞） 字节码 # 基本结构 操作字节码的工具 Javassist/ASM AOP 集合 # Collection,List,ArrayList,Vector,LinkedList, SkipList, Stack Queue HashMap/HashTable HashMap 扩容死循环问题 LinkedHashMap TreeMap HashSet,TreeSet WeakHashMap 并发相关的集合 ConcurrentHashMap CopyOnWriteArrayList IO # IO 模型 NIO Non-blocking IO Java 8 IO 相关的接口和类 Netty Vert.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2019-03-06-keynotes-of-new-java/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2019-03-01-rpi-cm3-emmc-flashing/">树莓派 CM3/CM3+ 刷写系统</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2019-03-01
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
              <a href="https://lewang.dev/tags/raspberry/">#Raspberry</a>&nbsp;
            
              <a href="https://lewang.dev/tags/raspbian/">#Raspbian</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2019-03-01-rpi-cm3-emmc-flashing/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2018-12-18-gitlab-docker-install/">使用 Docker 方式安装 Gitlab，没你想得那么简单</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2018-12-18
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 4 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/docker/">#Docker</a>&nbsp;
            
              <a href="https://lewang.dev/tags/gitlab/">#Gitlab</a>&nbsp;
            
              <a href="https://lewang.dev/tags/ssh/">#SSH</a>&nbsp;
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              为什么要写这篇文章？ # 曾经几年前在 Docker 还没有广泛应用的时候，在公司使用过源码的方式安装和升级过 Gitlab，虽远没有 Docker 方便，因为自己对 Linux 系统的理解，所以整体上感觉还是挺简单的。这几年随着 Docker 的普及，使得安装 Gitlab 更加的容易，不仅方便了我这样的老鸟，也更方便了小白用户们。但是 Gitlab 官方的 Docker 安装文档并没有写得很完善, 除了官方文档之外，检索出来的安装文档也是人云亦云，东拼西凑，结果也就是能运行起来，凑合着能用而已。避免出现下图中“我已经用 Docker 部署好啦”，其实已经翻车的情形。
我希望每做一件小事的时候也都能抱着“知其然知其所以然”的心态对待，用 Docker 方式安装 Gitlab，说简单来说就是一行命令的事儿，但是这样就够了吗？我看是不够的，所以就有了这篇文档。
本文需要达成的事项 # 在 CentOS 7 系统中安装 Docker 使用 Docker 方式安装中文版 Gitlab 和宿主机器共用 22(SSH) 端口 支持 SSH(22)/HTTPS(443) 方式推拉仓库 使用 SMTP 方式配置通知邮箱(腾讯企业邮箱) 改写默认的项目标签(Labels) 在 CentOS 7 系统中安装 Docker # 这部分参考 Docker 的官方文档, 罗列一下安装步骤, 细节请看 Docker 的官方文档。如果使用 root 用户安装，sudo 可以去掉。
1. 删除老版本 Docker # $ sudo yum remove docker \ docker-client \ docker-client-latest \ docker-common \ docker-latest \ docker-latest-logrotate \ docker-logrotate \ docker-selinux \ docker-engine-selinux \ docker-engine 2.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2018-12-18-gitlab-docker-install/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2017-12-31-year-end-reviews-of-2017/">有关 2017 流水账和胡思乱想的记录</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2017-12-31
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 2 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E5%9B%9E%E5%BF%86/">#回忆</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E6%80%9D%E8%80%83/">#思考</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E5%B1%95%E6%9C%9B/">#展望</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E7%BB%8F%E9%AA%8C/">#经验</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E6%95%99%E8%AE%AD/">#教训</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              好久没有写过文字了，前几篇文也是自己从 Google Doc 中摘出来的工作日志，拿来凑凑数，刷新下 Github 的时间线，有点儿不太像话。看看自己书桌上叠起来超过一尺高的新书才知道，想看的还没来得及看完，想学的也还没来得及学会，想做的也没有做得很好，一年就过去了。2017 是我来魔都的第 5 年，回想这 5 年，自己的成长还是很多的，但 2017 这一年，好像与 2016 并没有什么大的不同，这让自己感到很担忧。
在 2017 年的最后几天，终于离开了自己熟悉的工作环境，从自己的舒适空间加入了一个新的环境，我想这就是改变的开始，一个新的起点。
2017 是平淡的，可能和未来的每一年也不会有太大差别，尽管我不希望这样。元旦假期这 3 天有空的时候都在回想，但是又想不起有那些特别印象深刻的事情，以至于总结都不太好写下去。我想那不如就回想几个和自己有关系的场景，做一个清单好了：
Bye 2017 区块链和比特币 人工智能（AI） 物联网大数据 Insurtech 和 Fintech 关于个人职业发展的思考 Hello 2018 Bye 2017 # 编程语言学习 # Golang：完成基本语法学习（官方文档和《Go 语言实战》），可以无障碍阅读 Golang 项目代码（《自己动手写 Java 虚拟机》），并且可手动完成简单 Golang 项目用 Python 重写，主要有 eureka client Kotlin：除协程外，完成官方文档中所有语言部分的学习内容，并使用 kotlin 开发了 2 个项目，其中一个是用 kotlin 重写了 Aprereo CAS 的核心功能 TypeScript：完成基本语法学习，目前没有实际应用的场景，希望从 2018 起，自己在需要写 JavaScript 的地方，全部用 TypeScript 来代替 书籍阅读 # 阅读量太少，希望在 2018 年里能增大阅读量。
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2017-12-31-year-end-reviews-of-2017/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2017-08-03-lvm-in-action/">LVM 实战记录</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2017-08-03
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
              <a href="https://lewang.dev/tags/fdisk/">#fdisk</a>&nbsp;
            
              <a href="https://lewang.dev/tags/resize2fs/">#resize2fs</a>&nbsp;
            
              <a href="https://lewang.dev/tags/lvm/">#lvm</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              背景 # 阿里云云主机两块 100G 的云盘合一个逻辑卷（LV）来使用，单个的 100G 磁盘不够用，需要合在一起使用，并且方便以后扩容
基本知识 # 磁盘 /dev/xvdb /dev/xvdc 分区, 使用 fdisk 进行分区 fdisk &gt; n &gt; p &gt; 1..4, 主分区最多只有 4 个 准备分区后，将分区类型变为 LVM 分区，fdisk &gt; t &gt; 8e, 8e 是 LVM 类型 ID 物理卷（PV），卷组（VG），逻辑卷（LV），从磁盘分区创建 PV，通过 PV 创建 VG 或者把 PV 加入已有的 VG，在 VG 上创建 LV，LV 看起来就是逻辑的上磁盘，使用和真实的磁盘没什么明显区别, 在 LV 上构建文件系统 创建 # 创建物理卷 pvcreate /dev/xvdb1，对分区进行操作 创建 vg0 卷组 vgcreate vg0 /dev/xvdb1 查看卷组 vgdisplay， 可以看到卷组有多大 在 vg0 上创建 data 逻辑卷 lvcreate -L 99G -n data vg0 或者 lvcreate -l 25556 -n data vg0 创建文件系统 mkfs.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2017-08-03-lvm-in-action/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2017-07-23-log-processing-system/">日志收集和分析系统架构</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2017-07-23
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/flume/">#Flume</a>&nbsp;
            
              <a href="https://lewang.dev/tags/cassandra/">#Cassandra</a>&nbsp;
            
              <a href="https://lewang.dev/tags/kafka/">#Kafka</a>&nbsp;
            
              <a href="https://lewang.dev/tags/java/">#Java</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              背景 # 微服务，日志分散且种类多（php/java/python），用 docker 起应用，日志通过卷放在宿主机器指定目录下，服务有众多实例，metrics 数据也不仅相同，无论是日志还是 metrics 数据，都可以看作是时间序列数据
分散主要表现为：
多个主机 多个目录下多个文件 应用开发所使用的技术栈不同日志格式不同 web log（主要是 nginx） 各类事件 一些其它事务性的日志 日志为时间序列数据，包括：
系统日志: 各类系统产生的跟业务有关的日志或者与业务无关的日志 web 服务器日志：如 access.log/error.log 等有固定格式的日志 性能监控日志：打点记录各类服务的 metrics(全部为数值类型 long/double/bool) 系统日志 # 由时间戳、一些枚举值以及日志内容(变长字符串)组成
日志时间颗粒度：支持毫秒/秒 枚举值包括： [必选]主机名/host [必选]服务名/service [必选]实例编号/instance [必选]日记级别/level：info/debug/warn/trace/error 等 [可选]异常名/exception: 如果是异常，把异常名作为枚举值记录 [可选]线程名/thread: [可选]方法名/method： [可选]文件名/file： [可选]行号/line： 日志内容(变长字符串): 为实际记录的内容以及异常堆栈信息 web 服务器日志 # access log（nginx） 日志内容：主要是文本(string）或者一些系统 metrics 数据(数值类型 long/double)
日志存储和处理： # 数据磁带（1 周）：kafka 提供热数据检索（1 个月）：solr(or lucence based on cassandra) 日志存储（永久）： kariosdb/cassandra: 支持 double/long/string 类型，kariosdb 相当于在 cassandra 上面套了一个壳，这样简化了很多时间序列数据处理的操作 数据展示：grafana，官方支持 kariosdb 扩展：数据深度挖掘分析 系统架构 # 特点：
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2017-07-23-log-processing-system/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2017-07-15-log4j2/">Log4j2 快速入门</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2017-07-15
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/flume/">#Flume</a>&nbsp;
            
              <a href="https://lewang.dev/tags/log4j2/">#Log4j2</a>&nbsp;
            
              <a href="https://lewang.dev/tags/java/">#Java</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              背景 # Java 生态下的日志库太多，配置也不同，大多数情况下会使用 SLF4j (又引入了一个库)来抽象日志接口。在使用 Log4j2 后，发现可以不使用 SLF4j 了，并且配置变得更简单，可以使用 lombok 的 log4j2 注解等。
需要搞清楚
如何设置哪些日志要记录下来 日志记录到哪里去 LEVEL 日志级别： # 内置（有 Fatal）：All &lt; Trace &lt; Debug &lt; Info &lt; Warn &lt; Error &lt; Fatal &lt; OFF 还可以自定义： https://logging.apache.org/log4j/2.0/manual/customloglevels.html Appender: 日志输出的目的地 # 内置的目的地有：
console, files（FIle/RollingFile）, remote socket servers, Apache Flume, JMS, remote UNIX Syslog daemons, various database APIs &hellip; Appender 在接受到日志以后，可以通过级别过滤选择记录日志，具体配置： https://logging.apache.org/log4j/2.0/manual/appenders.html
Logger 负责决定哪些日志要记录和发配日志 # 哪些需要记日志，设置什么级别，并且配置日志输出到哪些个 Appender 中去都在 Logger 中配置。Logger 有类似继承的关系，名为 Root 的的 Logger 为所有 Logger 的根，也就是说没有做特殊设置（additivity=false), 那么这个 Logger 的日志将会记录到自己指定的 Appender，并且也都会记录到自己所有“父” Logger 设置的 Appender 中去
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2017-07-15-log4j2/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2017-06-06-xtrabackup/">MySQL 数据备份和不停机重新搭建主从同步</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2017-06-06
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/mysql/">#MySQL</a>&nbsp;
            
              <a href="https://lewang.dev/tags/xtrabackup/">#xtrabackup</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              背景 # 目前公司主要服务都是直接使用 MySQL 主服务器，从服务主要给离线数据分析服务使用，由于前期弄得比较简单的粗暴，从服务上还有一两个数据库在做生产使用, 并且从服数据已经不能和主服进行进行同步了，有大量错误，忽略都没有办法进行。此外，主服仅配置了三个核心数据的 binlog，随着业务的变化，其它数据库不能走主从这条路来同步数据，于是希望不停机的情形下重新调整主服配置，记录所有的数据库的 binlog，同时添加新的从服务器来同步数据
方案 1 # MySQL 的主从是通过同步 binlog 日志来实现数据同步的，于是需要想办法把从服数据先于主服同步，记录 binlog 的 pos 值，再配置从服从该 pos 处开始同步，考虑可以使用 mysqldump 导出所有 innodb 数据，使用 rsync 同步所有 myisam 数据文件，然后再开启主从同步。但是目前这种方案不适用，主服不能长时间停机
方案 2 # 使用 xtrabackup 来完成目标
主从服务器上都需要安装 xtrabackup（实际使用 xtrabackupex）：
yum install http://www.percona.com/downloads/percona-release/redhat/0.1-4/percona-release-0.1-4.noarch.rpm yum install -y percona-xtrabackup-24 主服： # 备份数据 # # 注意数据库名称的转义，例如 - 号是 @002d innobackupex --defaults-file=/etc/my.cnf --socket=/var/lib/mysql/mysql.sock --user=root --password=xxxx --parallel=2 --databases=&#34;db1 db2&#34; /data/backup/xtrabackup/ 保持事务一致 # innobackupex --apply-log /data/backup/xtrabackup/2017-06-06_13-16-21/ 同步数据 # rsync -avHz 2017-06-06_13-16-21 sysops@cow:/data/backup 从服： # 修改 my.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2017-06-06-xtrabackup/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2016-01-28-banlinpai/">办理机动车临牌</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2016-01-28
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E9%AD%94%E9%83%BD%E7%94%9F%E5%AD%98%E6%89%8B%E5%86%8C/">#魔都生存手册</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E4%B8%B4%E7%89%8C/">#临牌</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2016-01-28-banlinpai/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2015-10-15-huanzheng/">驾照转入换证</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2015-10-15
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E9%AD%94%E9%83%BD%E7%94%9F%E5%AD%98%E6%89%8B%E5%86%8C/">#魔都生存手册</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E9%A9%BE%E7%85%A7/">#驾照</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2015-10-15-huanzheng/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2014-10-16-tuning-nginx/">Nginx 性能调优「译」</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2014-10-16
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 2 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/nginx/">#Nginx</a>&nbsp;
            
              <a href="https://lewang.dev/tags/tuning/">#tuning</a>&nbsp;
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
              <a href="https://lewang.dev/tags/performance/">#performance</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              这是一篇译文，原文链接：Tuning NGINX for Performance
Nginx 为人熟知的是在负载均衡、静态缓存和 WEB 服务器等方面的高性能，目前世界上最繁忙的站点中大约有 40% 在使用 Nginx。绝大多数情况下，大多数默认的 Nginx 和 Linux 配置都可以工作得非常好，但也需要做一些优化以获得最好的性能。本文将讨论在优化系统时需要考虑的 Nginx 和 Linux 的部分配置。可配置的选项有很多，但是本文只涵盖推荐大多数用户调整的配置选项。本文没有涵盖的配置选项，只有那些对 Nginx 和 Linux 有了深入的理解的人或者获得了 Nginx 技术支持和专业的服务团队的推荐建议后，才可以考虑调整。Nginx 专业服务器团队已经为世界上一些最繁忙的站点通过优化 Nginx 获得了最高水平的性能，并且可以为任何需要获得自己系统最大产出的客户服务。
简介 # 本文假设读者对 Nginx 架构和配置的概念已有了基本的了解。Nginx 的文档内容将不会在本文中重复，但本文会提供各项配置简要的介绍和相关文档的链接。
在性能调优时，要遵循一个好的规则：一次只修改一个配置选项，如果这个修改没有在性能方面带来优化，那么要再改回默认值。
我们从 Linux 性能优化的讨论开始，因为 Linux 性能优化的一些值会影响到 Nginx 的一些配置。
Linux 配置 # 尽管现代 Linux 内核（2.6+）在各种配置情况下都工作得很好，但也有一些配置是想要修改的。如果操作系统的配置设置的太低，那内核日志将会有错误信息，从而得知哪些配置需要调整。Linux 性能优化可能涉及的配置有很多，这里我们只讨论那些优化达到正常工作负载最有可能涉及到的那些配置。调整这些配置请参考详细的 Linux 文档。
Backlog 队列 # 下面的配置选项与网络连接和其排队方法直接相关。如果连入率很高（译者注：客户端发起的连接很多）且系统性能配置不匹配，例如一些连接表现得有所停顿，那么修改下面得配置将可能有用。
net.core.somaxconn: 设置等待 Nginx 接受的连接队列的大小。由于 Nginx 接受连接非常的快，这个值通常情况下不用设置得很大，但系统默认值可能比较小，所以对于流量比较大的站点，增大这个值是个不错的想法。如果这个值太小，在内核日志中应该会看到错误消息，那么就需要增大这个值，直到错误消失。注意：若将这个值设置为大于 512 的话，那么需要在 Nginx 配置中修改 listen 指令的 backlog 参数来匹配这个数字。
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2014-10-16-tuning-nginx/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2014-05-06-github-pages-dns-settings/">Github Pages 服务的域名设置</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2014-05-06
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 2 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/github/">#github</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              这几天每次 Push 博客到 Github Pages 时总会收到一封邮件：
The page build completed successfully, but returned the following warning:
GitHub Pages recently underwent some improvements (https://github.com/blog/1715-faster-more-awesome-github-pages) to make your site faster and more awesome, but we&rsquo;ve noticed that iforget.info isn&rsquo;t properly configured to take advantage of these new features. While your site will continue to work just fine, updating your domain&rsquo;s configuration offers some additional speed and performance benefits. Instructions on updating your site&rsquo;s IP address can be found at https://help.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2014-05-06-github-pages-dns-settings/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2014-04-26-power-of-understanding/">悟性</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2014-04-26
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E6%80%9D%E8%80%83/">#思考</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2014-04-26-power-of-understanding/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2014-04-25-grow-up/">成长</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2014-04-25
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E5%BF%83%E6%83%85/">#心情</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2014-04-25-grow-up/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2014-03-13-who-is-de-broglie/">谁是德布罗意</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2014-03-13
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E7%89%A9%E7%90%86/">#物理</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2014-03-13-who-is-de-broglie/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2014-03-06-arch-of-website-domain-cdn/">从域名和 CDN 来看网站架构</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2014-03-06
            </time>

            
              



            
          
          


          
            <span class="post-read-time"
              >— 2 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/technical/">#Technical</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              为了自己做好网站的架构，找了知乎，豆瓣，大众点评和百姓网来做参考。这里主要来看域名和 CDN 相关的部分，后台的架构也还是要边学便实践。
大概情况 # 从前端分析了知乎的域名和 DNS 情况，同时对比了一下豆瓣、大众点评和百姓网。从域名、DNS、CDN 等使用角度来说，他们之间大同小异。
使用的分析工具 # Chrome WHOIS DNSLookup 非 CDN 使用 # 记录 域名 用途 路径 A zhihu.com 使用 301 跳转到 www.zhuhu.com IP A zhi.hu 使用 302 跳转到 www.zhihu.com IP A www.zhihu.com IP A comet.zhihu.com WebSocket 推送消息 IP A analytics.zhihu.com 知乎自己的统计分析，同时使用了 Google Analytics IP 大部分都是用了 301 或者 302 跳转，注意他们的区别：301 是永久跳转(浏览器会做客户端端缓存)，而 302 是临时跳转。此外 baidu.com 到 www.baidu.com 并不是使用 301 或者 302 ，而是使用下面的一段 HTML 代码
&lt;html&gt; &lt;meta http-equiv=&#34;refresh&#34; content=&#34;0;url=http://www.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2014-03-06-arch-of-website-domain-cdn/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2014-03-03-building-devenv-by-vagrant/">使用 Vagrant 构建开发环境</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2014-03-03
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/virtualbox/">#virtualbox</a>&nbsp;
            
              <a href="https://lewang.dev/tags/vagrant/">#vagrant</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              Vagrant 是一个构建虚拟开发环境的利器，它使得在团队中很容易共享开发环境，有了它，不必每个人都搭建一个自己的开发环境了。在没有使用 vagrant 之前，我在 windows 中安装了 virtualbox，然后在 virtualbox 中安装了一个 ubuntu server。在 ubuntu 中安装了 mysql、jdk 等软件，并且设置了一个共享目录，以便于将工程代码直接共享给 ubuntu。在外部开发调试过程中（Java 项目），我需要在 virtualbox 中设置好几个端口映射，如 mysql，ssh 等等。这样在 cygwin 里面就可以通过 ssh 登录 ubuntu server 了，为了使得 ssh 登录不用每次设置密码，还需要手动生成公钥私钥。换机器了，这一切我又得重新配置。新同事来了，他也得像我这样重新配置一遍。有可能他还会有问题说：为什么按照你的说明，代码在我这里却无法运行呢？
一切都从 Yining 告诉了我 vagrant 之后发生了变化，原来一切都这么简单。
安装 VirtualBox # Vagrant 其实是对 virtualbox 做了一层包装，它让使用 virtualbox 作为虚拟机更为简单。当然也可以使用 vmware，使用 vmware 那得找一个 license 了。
好吧，去这里 下载 VirtualBox。我使用的是 4.3.8 for OSX
安装 Vagrant # 下载 vagrant
添加虚拟机镜像到 Vagrant # vagrant box add vdevenv ~/Workspace/vagrant/boxes/vdevenv-0.0.0.1.box vagrant 的干净的镜像可以在这里下载:
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2014-03-03-building-devenv-by-vagrant/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2014-03-02-python-on-my-rmbp/">Python on My rMBP</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2014-03-02
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/python/">#python</a>&nbsp;
            
              <a href="https://lewang.dev/tags/virtualenv/">#virtualenv</a>&nbsp;
            
              <a href="https://lewang.dev/tags/pip/">#pip</a>&nbsp;
            
              <a href="https://lewang.dev/tags/easy_install/">#easy_install</a>&nbsp;
            
              <a href="https://lewang.dev/tags/rmbp/">#rMBP</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              前几天入手了一台 Macbook Pro Retina，把 BIG 提到了很爽的地步。经过几天的折腾，可以和 windows，ubuntu desktop 说 Byebye 了。之前整整用了一年的 Ubuntu 来工作，我用它来写 C、Java 和 Python, 要是 windows 没有 cygwin, 没有 MacType，那该多么恐怖。后来用了一段时间的 MBP，让我坚定了以后要自己买一个 MBP。
ubuntu 那么的惹人爱，因为它有个还挺好用的 GUI，从 debian 那继承过来的 apt-get, 一下子把一个从 redhat 9 用到 fedora 4 的穷学生拉到了 ubuntu 的阵营，至此，deskop 就被 ubuntu 占领了。在此之前，我还用段时间的 debian 和 gentoo。
不得不说，debian 太伟大太牛逼了，有一次要在一个 MIPS 的小设备上编译安装 erlang， openssl，libcurl 等做一些实验, 要跨平台编译这些软件安装到小设备上去，费了半天终于把这些都编好了，还写了一个编译脚步，结果 erlang 运行的时候虚拟机总是报错，也不知道怎么回事。后来注意到 debian 居然有 MIPS，ARM 的源，后来在 MIPS 设备上安装软件做实验，我再也没有遇到问题，一切都用 apt-get 搞定了。
除了 apt-get, 我想最令我惊喜还有 ubuntu 自带了 python 2.7，让我很容易在两台电脑之间拷贝文件：
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2014-03-02-python-on-my-rmbp/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2013-08-09-benchmark-of-aliyun-and-ucloud/">阿里云和 ucloud 云主机评测</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2013-08-09
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 4 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/aliyun/">#aliyun</a>&nbsp;
            
              <a href="https://lewang.dev/tags/ucloud/">#ucloud</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              总体说明 # 我使用联通 10M 光网，SSH 在多个时间段登录两个主机都是非常的快，但是阿里云的 SSH 有时会断开连接，需要重新登录(一天遇到 n 次)，ucloud 一次都没有断开连接过。两者总体操作上都很流畅。平时我比较习惯于使用 ubuntu，于是在两个主机上都安装了 Ubuntu 12.04_64 的 Server 版本。在安装初始化系统过程中(测试过两次)，Ucloud 的速度要快于阿里云主机，粗略估计都是在 20s 以内，因此差别不大。
阿里云主机安装过程中不需要人为参与，选好主机配置即可，主机一旦创建完成，用户名和口令会发送到测试者手机上，而且直接发送的是 root 账户口令。Ucloud 除了选择配置之外，还需要设置强登录密码，使用普通用户登录，感觉更 geek 一点。
默认情况配置下，关闭重启服务器，Ucloud 会发送主机变化短信到手机，阿里云不会。阿里云在系统负载预警方面比较全面，ucloud 侧重于 server 上在线状态和相关服务的预警。
在试用和测试过程中我主要偏向于静态的测试，后面还有一个好玩的 Super PI 测试。
阿里云和 ucloud 都是主机，和实际的服务器使用上没有什么区别。另外阿里云有 paas，需要单独购买，目前支持 php 和 nodejs，一些基本的服务如 memcached 等都可直接使用。
如果做互备，如果我们不使用这两个云平台各自特有的一些服务(主要是阿里云有一些如开放存储服务 OSS 等)，相互切换难度上应该是差不多的。
主机概览 # 项目 阿里云 ucloud 按量付费 支持(不能升级或者调整主机配置*) 不支持 包年包月 支持 支持 操作系统 可重置 可重装 CPU 升级 支持(需要关机) 支持(需要关机) 内存升级 支持(需要关机) 支持(需要关机) 磁盘扩容 支持，可以升级或者添加新的磁盘，最大为 2000G 支持，可以扩容最大到 1000G（与系统盘在同一个主机上），&lt;/br/&gt;或者添加新的网络磁盘 udisk 磁盘镜像 支持 支持 带宽升级 支持 支持 其它服务[需要单独购买] # 项目 阿里云 ucloud 负载均衡服务 支持(目前免费)，需要两台主机以上 支持(目前免费)，需要两台主机以上 关系型数据库服务 支持，mysql 和 sqlserver 支持，mysql 和 percona 特有的服务 开放存储服务 OSS、开放数据处理服务 ODPS、开放结构化数据服务 OTS CDN、短信服务（可二次开发）、与又拍、DNSPod 和搜狐 SendCloud 直接绑定 *按量付费不支持更换操作系统；不支持配置变更功能（包括带宽升级、CPU 和内存升级、新增数据盘）;“包年包月“和”按量付费“不支持相互更换;1 台云服务器只能选择 1 种，无法同时选择
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2013-08-09-benchmark-of-aliyun-and-ucloud/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2013-03-04-so-load-path-in-linux/">Linux 共享库（动态链接库）相关的一些记录</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2013-03-04
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/linux/">#Linux</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              相关的环境变量 # LD_LIBRARY_PATH ld-linux.so 寻找 shared object 的路径，优先加载出现在路径前面的 shared object。如，export LD_LIBRARY_PATH=/home/user/lib:$LD_LIBRARY_PATH LD_PRELOAD 指定优先供 ld-linux.so 加载的 shared object。如，export LD_PRELAOD=/home/user/lib/glibc.so，可以使用这个变量来改变加载顺序，例如我们自定义的 glibc.so 中实现了新的 strcmp 之类的函数，那么可以使用这个变量来实现函数的替换，实现注入 LD_DEBUG 使用这个环境变量来 debug 载入 shared object 的情况。如，export LD_DEBUG=files,这样会打印所有所有加载 shared object 的记录 一些工具 # 如何查看一个程序或者 shared object 加载哪些 shared object ldd，可以查看程序或者.so，如，
$ ldd ./foo_test $ ldd ./libfoo.so 对于已经运行的程序，可以这样 $ cat /proc/PID/maps | awk &#39;{print $6}&#39;| grep &#39;\.so&#39;| sort | uniq $ lsof -p PID | awk &#39;{print $9}&#39; | grep &#39;\.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2013-03-04-so-load-path-in-linux/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2012-11-13-about_openlayers/">关于openlayers的一些说明</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2012-11-13
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2012-11-13-about_openlayers/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2012-11-06-how_to_use_gdb_to_find_the_kernel_source_code/">使用gdb根据指令地址定位到C代码对应的行</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2012-11-06
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              最近做一些Kernel方面的工作，从一头雾水开始，多做些记录吧。
addr2line也可以根据指令地址定位C代码对应的行，但是对于Kernel module却不是很方便，使用gdb就要容易得多。
NOTE：在使用gdb定位C代码之前需要开启-g选项编译内核或者module
例如有这样的Call Trace
Call Trace:
[&lt;8033265c&gt;] dump_stack+0x8/0x30
[&lt;8003abbc&gt;] warn_slowpath_common+0x70/0x98
[&lt;80041f10&gt;] local_bh_enable_ip+0x98/0xec
[] ieee80211_alloc_node+0x29c/0x47c [umac]
[] ieee80211_reset_bss+0x58/0x154 [umac]
[] ieee80211_vap_attach+0x20/0x68 [umac]
[] ath_vap_create+0x430/0x6b0 [umac]
[] wlan_vap_create+0x58/0x210 [umac]
[] osif_ioctl_create_vap+0x268/0x790 [umac]
[] ath_ioctl+0x134/0x94c [umac]
[&lt;8022db50&gt;] dev_ioctl+0x28c/0x88
现在想定位指令：
[&lt;80041f10&gt;] local_bh_enable_ip+0x98/0xec
可以这样做：
$ mips-linux-gdb vmlinux
GNU gdb 6.8
Copyright (coffee) 2008 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later http://gnu.org/licenses/gpl.html
This is free software: you are free to change and redistribute it.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2012-11-06-how_to_use_gdb_to_find_the_kernel_source_code/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2012-11-06-quick_makefile/">几个简单的Makefile</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2012-11-06
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 2 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              几个简单适合小程序的Makefile，可直接拷贝使用，自己mark一下，这样长时间不用Makefile也不用去看手册了
0.只有一个文件
变量的定义，方便使用 # CC = gcc
CCFLAGS = -O2 -s
BIN = test
OBJ = root_password_tool_win32.o
$(BIN) : $(OBJ)
$(CC) $(CCFLAGS) -o test $(OBJ)
$(OBJ) : root_password_tool_win32.c
$(CC) $(CCFLAGS) -c root_password_tool_win32.c
.PHONY : clean
clean :
-rm $(BIN) $(OBJ)
1.简单编译命令行程序，$(CC)前面是tab，不是space
一共五个文件：
test.c
md5.c md5.h
password.c password.h
main函数在test.c中，test.c文件include了md5.h和password.h
CC = gcc
CCFLAGS = -O2 -s
BIN = password
OBJ = md5.o password.o test.o
$(BIN) : $(OBJ)
$(CC) $(CCFLAGS) -o password $(OBJ)
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2012-11-06-quick_makefile/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2012-10-18-bandwidthlimiter/">Java程序如何限速(控制下载和上传速度)</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2012-10-18
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 4 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              好久没有在这里写点东西了，要养成书写记录的习惯。
这里简单的讨论一下java设计网络程序中如何控制上传和下载速度，我们常见的FTP，HTTP，BT等协议都是TCP的，但是现在流行的utorrent却基于UDP实现了自己UTP协议(UDP+拥塞控制)，不管使用什么协议，站在I/O的角度来说，限速的控制思路都是一样的。
思路很简单，如下：
1.假设下载或者上传速度上限是m (KB/s),那么发送一个固定的字节数据(假设是n字节)的时间花费是：n/m；
2.假设现在要发送n字节的数据，那么理论所需的时间应该是n/m，而在实际情况下，发送n字节的数据只花费了t秒，那么发送该发送线程就应该睡眠n/m-t秒，这样就基本实现了速度的控制。
代码以TCP为例
速度控制
1 package com.actiontec.net.bandwidth;
2
3 /**
4 *
5 * @author Le
6 *
7 /
8 public class BandwidthLimiter {
9
10 / KB /
11 private static Long KB = 1024l;
12
13 / The smallest count chunk length in bytes /
14 private static Long CHUNK_LENGTH = 1024l;
15
16 / How many bytes will be sent or receive /
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2012-10-18-bandwidthlimiter/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2012-08-22-router-dhcp/">把ubuntu配置成路由器+DHCP</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2012-08-22
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 2 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              资源： __ __
PC A: Ubuntu 12.04 LTS，两块网卡，分别为eth0和eth1，使用eth0连接 互联网 __ __
PC B: Windows 7, 一块网卡，为eth0 __ __
目标： __ __
使得B通过A连接互联网(IPv4)，即实现A为路由器的功能 __ __
步骤： __ __
PC A: __ __
(0)假设eth0已经配置好，PC可以通过eth0连接互联网 ，配置eth1为，如/etc/network/interface所示 __ __
auto lo __ __
iface lo inet loopback __ __
auto eth0 __ __
iface eth0 inet static __ __
address 172.16.10.65 __ __
gateway 172.16.10.254 __ __
netmask 255.255.0.0 __ __
auto eth1 __ __
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2012-08-22-router-dhcp/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2012-03-22-a-short-discuss-of-simplexml-of-php/">再说 PHP 中 SimpleXML</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2012-03-22
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/php/">#php</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              前一篇帖子使用了 xpath，后来了解到 xpath 的性能可能比较差，而且在遇到有命名空间的时候还有点小麻烦。这里都已豆瓣提供的 API 返回的 xml 为例。豆瓣返回的 xml 不是 rss 格式的，而是 Atom 格式，有很多的命名空间，如果习惯于操作 rss 格式的 xml，那么可以直接把 xml 里面的命名空间的字符串都 replace 掉，这个方法貌似很简单很暴力，就不会遇到命名空间的问题了。
从豆瓣 API 开始，点击这个链接 http://api.douban.com/book/subjects?q=java 你就可以看到 xml 格式，由于返回的是 Atom 格式的 xml，浏览器会自动帮你解析，所以应该这样
# 这样就可以得到一个java.xml文件。 $ wget -O java.xml http://api.douban.com/book/subjects?q=java 这样就可以得到一个 java.xml 文件，接下来使用 SimplePHP 处理这个文件。
首先要创建一个 SimpleXML 对象
//$content为xml的内容 $xml = new SimpleXMLElement($content); 现在要获取 opensearch 命名空间下的 totalResults 节点的文本，代码如下：
$children = $xml-&gt;children(&#39;http://a9.com/-/spec/opensearchrss/1.0/&#39;); $totalResults = $children-&gt;totalResults; 处理所有 xml 文档中所有的 entry 节点
//处理所有找到的记录 $entries = $xml-&gt;entry; foreach($entries as $entry){ //取命名空间下的孩子节点 $entryChildren = $entry-&gt;children(&#39;http://www.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2012-03-22-a-short-discuss-of-simplexml-of-php/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2012-03-13-things-i-create-must-be-cool/">我想做的东西可以不值钱，但是它必须‘酷’</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2012-03-13
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/idea/">#idea</a>&nbsp;
            
              <a href="https://lewang.dev/tags/fackbook/">#fackbook</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2012-03-13-things-i-create-must-be-cool/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2012-03-10-at-a-late-night/">在这安静的夜里</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2012-03-10
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E5%BF%83%E6%83%85/">#心情</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2012-03-10-at-a-late-night/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2012-01-09-for-baigetan-2012/">写给 2012 的摆摊</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2012-01-09
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E5%BF%83%E6%83%85/">#心情</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2012-01-09-for-baigetan-2012/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-12-01-how-to-use-simplexml-of-php/">SimpleXML使用xpath</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-12-01
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/php/">#php</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              这几天没心情看论文，于是开始写写摆摊网的代码。摆摊主要做高校二手书籍信息的分享，于是需要从豆瓣上获取图书信息，豆瓣提供了一个完整的 xml 来描述一本书，例如http://api.douban.com/book/subject/isbn/9787543639136，于是需要处理这个 xml 来获取相应信息，这里小码哥采用的是直接使用 xpath 来获取 xml 文档中相应的信息。摆摊使用了 sae，于是使用 SimpleXML 来处理 xml，加上自己还只是 PHP 的初学者，于是出现了一些问题。
这里是一些学习资料：
xpath:http://www.w3school.com.cn/xpath/ simplexml:http://cn2.php.net/manual/en/simplexmlelement.xpath.php 新建 SimpleXMLElement 对象，xml 文件内容在$content 中
$bookFromDouban = new SimpleXMLElement($content); 直接查询，在命名空间 db 下的所有 attribute，且有 name 属性，以下 xpath 查询是没有问题的，
$result = $bookFromDouban-&gt;xpath(&#34;//db:attribute[@name]&#34;); 但是，这条查询就有问题了，如下，
$result = $bookFromDouban-&gt;xpath(&#34;//link[@rel=&#39;self&#39;]|//link[@rel=&#39;image&#39;]&#34;); 上面的代码表示在默认的命名空间里面查询 link 节点，但是在 php 5.0 以上却不能查出数据。需要这样操作
//获取这个xml的所有的命名空间 $namespaces = $bookFromDouban-&gt;getNamespaces(); //注册默认的命名空间为&#39;d&#39; $bookFromDouban-&gt;registerXPathNamespace(&#39;d&#39;, $namespaces[&#39;&#39;]); //现在这个查询就ok了 $result = $bookFromDouban-&gt;xpath(&#34;//d:link[@rel=&#39;self&#39;]|//d:link[@rel=&#39;image&#39;]&#34;); 对$result 遍历就简单了，这里也给出一个简单的例子，遍历完，变量就初始化了。PS：代码写的不优雅，欢迎拍砖。
translator = array(); $author = array(); $i = $j = 0; foreach($result as $item) { foreach($item-&gt;attributes() as $val) { $val = str_replace(&#39;-&#39;,&#39;_&#39;,$val); if($val == &#39;author&#39;) { $author[$i++] = &#39;&#39;.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-12-01-how-to-use-simplexml-of-php/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-12-01-when-datatype-is-json/">jquery $.ajax() 中 datatype 为 json 时的问题</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-12-01
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/jquery/">#jquery</a>&nbsp;
            
              <a href="https://lewang.dev/tags/ajax/">#ajax</a>&nbsp;
            
              <a href="https://lewang.dev/tags/json/">#json</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              最近在为摆摊写点前端 js 的时候，在使用 jquery 的 $.ajax()这个方法的时候，当 datatype 设置为 json 时，总是不执行 success 回调，而是执行 error 回调。而将 datatype 设置成 text，就可以执行 success 回调了，摆摊使用的是 jQuery JavaScript Library v1.6.2，查看 jQuery 文档可知：
“json”: Evaluates the response as JSON and returns a JavaScript object. In jQuery 1.4 the JSON data is parsed in a strict manner; any malformed JSON is rejected and a parse error is thrown. (See json.org for more information on proper JSON formatting.)
我用 php 产生的字符串是
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-12-01-when-datatype-is-json/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-11-09-future-is-unknown/">未来是个未知数</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-11-09
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E5%BF%83%E6%83%85/">#心情</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-11-09-future-is-unknown/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-11-08-think-of-baigetan/">关于摆摊的一些思考</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-11-08
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E5%BF%83%E6%83%85/">#心情</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-11-08-think-of-baigetan/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-11-07-design-of-baigetan/">摆摊网页面设计</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-11-07
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/php/">#php</a>&nbsp;
            
              <a href="https://lewang.dev/tags/database/">#database</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-11-07-design-of-baigetan/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-10-27-winter-is-coming/">冬天来了</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-10-27
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E5%BF%83%E6%83%85/">#心情</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-10-27-winter-is-coming/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-10-21-process-of-baigetan/">摆摊的一些进展</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-10-21
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E5%BF%83%E6%83%85/">#心情</a>&nbsp;
            
              <a href="https://lewang.dev/tags/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/">#系统架构</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-10-21-process-of-baigetan/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-10-01-snapshot-of-10-1/">十一掠影</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-10-01
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/%E6%91%84%E5%BD%B1/">#摄影</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-10-01-snapshot-of-10-1/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-09-28-hello-baigetan/">摆摊网</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-09-28
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/life/">#Life</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-09-28-hello-baigetan/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-08-15-openlayers-custom/">改造openlayers构建轻量级专用地图信息系统（1）</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-08-15
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-08-15-openlayers-custom/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2011-05-11-mark2011/">mark一下学习计划</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2011-05-11
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2011-05-11-mark2011/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2010-10-11-how_to_do_with_openlayers/">openlayers小结(有参考项目代码)</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2010-10-11
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 5 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              最近一段时间里，又做了一个跟openlayers相关的项目，但是到目前为止，我对openlayers还是不怎么了解，做东西也只是参考了openlayers的例子，以及自己的一些对openlayers用法的一些猜测。openlayers是一个用js实现的GIS前端框架，我的js目前还是打酱油的水平，要是没有jquery，那就基本写不了几行js代码了。js那是相当的强大，再加上VML\SVG、HTML5以及很多js rich框架等等，感觉js在浏览器端真是无所不能啊
目前这个项目主要功能就是在某城市的地图上标示电缆、光缆、井盖、光缆接头、线杆、建筑物形状和位置、各分级单位的位置以及快速定位等等，要求的功能很简单，而且有前段时间做学校电子地图的一些积累，所以大概在两周左右就做完了这个项目。
感觉openlayers的资料很少，自己也没有太多的时间和精力去读它的源码，目前我都是通过看openlayers自带的那些example和api文档来摸索的，下面简单总结一下openlayers的相关用法，欢迎大家拍砖。
（以下均以OpenLayers-2.9.1为例说明，完整的项目代码在这里下载,地图图片http://121.193.130.68/list/）
1、我只用到了openlayers里面的tilecache接口，其它的例如WMS，google map等等都没有用到。原因是这样的。tilecache接口是用来从tilecache服务器上请求图片的。通过观察google map或者一些其它的地图服务，发现他们都是使用256x256像素大小的图片（也就是tile）来拼接地图的，通常的做法是在gis服务器之间架设一个tilecache服务器，这样，gis生成的图片就可以缓存在tilecahe服务器上，而tilecache服务器仅仅提供简单http服务即可，如果请求的图片(tile)不在tilecache服务器上，那么tilecache服务器会想gis服务器请求，把把gis生成的图片缓存在tilecache服务器上。
通过观察tilecache服务器的目录结构，发现缓存图片按照这样的模具结构存放：{缩放级别}/{横坐标}/{纵坐标}.{图片格式后缀名}，注意这个坐标系的原点在屏幕的左下角。观察到这个规律以后，就可以直接把一张大的地图按照256x256的大小切割，并按照上述的目录结构存放，值得注意的是，每个缩放级别要一定满足2^n的规律，即第一级整个地图大小若为1，那么第二级整个地图大小应为2，第三级应为4，依次类推。这里需要简单修改一下openlayers的tilecache接口代码，文件位于OpenLayers-2.9.1\lib\OpenLayers\Layer\TileCache.js,修改如下：
1 var components = [
2 this.layername,
3 zeroPad(tileZ, 2),
4 //zeroPad(parseInt(tileX / 1000000), 3),
5 //zeroPad((parseInt(tileX / 1000) % 1000), 3),
6 zeroPad((parseInt(tileX) % 1000), 3),
7 //zeroPad(parseInt(tileY / 1000000), 3),
8 //zeroPad((parseInt(tileY / 1000) % 1000), 3),
9 zeroPad((parseInt(tileY) % 1000), 3) + &lsquo;.&rsquo; + this.extension
10 ];
同样，由于只使用tilecache，所以openlayers里面其它的代码也可删除，以减小openlayers的代码量，最后通过自带的python写的工具，压缩openlayers代码即可。
2.地图初次加载的时候，向服务器请求所有数据信息，并在地图上绘出相应的点线面。如何画出建筑的轮廓？用透明的就行了。
a.显示点信息,包括画点、用图标显示点，代码如下。
1 /*
2 * 在地图上画出所有的点并保存点的相关信息到字典中
3 */
4 function initFeaturePoint(vectorLayer,categoryId){
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2010-10-11-how_to_do_with_openlayers/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2010-09-18-snda/">小记盛大校园牛人创新技术大赛</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2010-09-18
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2010-09-18-snda/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2010-01-11-del-firefox-address/">删除Firefox地址栏下拉列表中的指定记录</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2010-01-11
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2010-01-11-del-firefox-address/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2009-11-23-libfetion/">用飞信(libfetion)定时发天气预报</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2009-11-23
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 3 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              什么是libfetion？请访问http://www.libfetion.cn/查看
以下都是在ubuntu下进行的
参考
http://www.libfetion.cn/Docs-dve/Build-LibFx-on-ubuntu.txt
请使用svn客户端下载libfetion-gui的源码
http://libfetion-gui.googlecode.com/svn/
安装开发过程中需要的软件
1 sudo apt-get install libc-dev
2 sudo apt-get install g++
3 sudo apt-get install libcurl4-openssl-dev
在trunk/qt4_src/libfetion/lib目录下找到静态库libfetion_32.a，由于代码打算是用python来写，所以制作了一个动态库libfetion.so
具体步骤如下：
#解压静态库为*.o
ar -x libfetion_32.a
#重新封装为so
g++ -shared -Wall -fPIC -lcurl -pthread *.o -o libfetion.so
#查看so[可选步骤]
nm libfetion.so
发送天气预报的python代码如下，libfetion.so中具体的方法请查看trunk/qt4_src/libfetion/include/libfetion/libfetion.h
1 #!/usr/bin/env python
2 #coding=utf-8
3 #only can run at linux
4 import os
5 import ctypes
6 import urllib2
7
8 #城市代码列表
9 city_codes = {
10 &lsquo;合肥&rsquo; : &lsquo;CHXX0448&rsquo;,
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2009-11-23-libfetion/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2009-07-10-e-campus/">使用Openlayers搭一个E校园(e-campus),类似e都市，6d校园</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2009-07-10
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2009-07-10-e-campus/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2009-07-09-jquery-msn/">使用jquery+jQuery Cycle Plugin实现MSN首页图片滑动切换效果</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2009-07-09
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              初学jquery，觉得很好玩。欢迎拍砖指正
我实现的效果截图
msn的效果截图
全部是js实现的，效果还不错，可以IE7，ff3，Chrome上正常运行,这里是demo[查看]
其中使用了jquery1.3.2[下载]，jquery.cycle.all.js[下载] 所有文件在这里[下载]
1 body {
2 font-family: Arial, Helvetica, sans-serif;
3 font-size: 12px;
4 font-style: normal;
5 line-height: normal;
6 font-weight: normal;
7 }
8 .clear{
9 clear:both;
10 height:0px;
11 }
12 .hot {
13 background-color: #F7F7F7;
14 height: 227px;
15 width: 302px;
16 border: 1px solid #DEDEDE;
17 padding-right:5px;
18 }
19
20 .hot_pic {
21 height: 190px;
22 width: 250px;
23 padding: 0;
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2009-07-09-jquery-msn/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2009-04-08-appenginejavaoverview/">appengine支持Java了</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2009-04-08
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              刚刚登录appengine的时候才发现开始支持java了。
上午的时候还没有。
对java的比较熟悉，但是还是喜欢比较简洁的python
http://code.google.com/intl/zh-CN/appengine/docs/java/overview.html
&lt;http://googleappengine.blogspot.com/2009/04/seriously-this-time-new-language- on-app.html&gt;
这是注册试用后google appengine给发的邮件:
Hello,
Thanks for signing up to try Google App Engine for Java! Your account has now
been activated, so you can begin building applications with our new Java
runtime.
Please note that this is still an early look at our support for the Java
language and you may encounter issues during development. We look forward to
hearing your feedback! To learn more, please visit:
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2009-04-08-appenginejavaoverview/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2009-03-25-python-start/">初识python</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2009-03-25
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              以教程中的一段小诗开始：
Programming is fun
When the work is done
if you wanna make your work also fun:
use Python!
1 #!/usr/bin/env python
2 #coding=utf-8
3 poem = &lsquo;&rsquo;&rsquo;\
4 Programming is fun
5 When the work is done
6 if you wanna make your work also fun:
7 use Python!
8 &rsquo;&rsquo;&rsquo;
9
10 f = file(&lsquo;c:\\poem.txt&rsquo;,&lsquo;w&rsquo;)
11 f.write(poem)
12 f.close()
哇，下面这段真是解释性的脚本语言的魅力啊，动态生成语句，然后直接解释执行，太灵活了
1 #!/usr/bin/env python
2 #coding=utf-8
3 stm = &lsquo;a = 10&rsquo;
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2009-03-25-python-start/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2009-03-12-gs-china/">中国各城市的经纬度数据(精确到县级城市)</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2009-03-12
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 3 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              经纬度数据收集自 维北有斗-天文爱好者的乐园
编写这篇博文有几个目的：
首先认识了两个单词
latitude [lat·i·tude || &rsquo;lætɪtuːd /-tjuːd] n. 纬度; 回旋余地, 自由; 纬度地区
longitude [lon·gi·tude || &rsquo;lɑndʒɪtuːd /&rsquo;lɒndʒɪtjuːd] n. 经度; 经线
1.学习dom4j的简单用法
2.做一个方便使用的全国城市经纬度数据库
3.利用google天气api做一个全面的天气预报服务
4.学习用python编写webservice
内容：
1.学习dom4j的简单用法
收集了的经纬度都是按照城市分开的单独的htm文件，我已经处理过为符合html4.0标准的html文件了，即所有的标识都是成对的，这里可以下载这些文件(点击下载经纬度html包)
(1)如何使用dom4j读入xml文档
使用dom4j读入xml文档代码片段
1 File file = new File(&ldquo;G:\\workspace\\test.xml&rdquo;);
2 SAXReader reader = new SAXReader();
3 //根据实际情况设置编码
4 reader.setEncoding(&ldquo;GBK&rdquo;);
5 Document doc = reader.read(files);
6
7 //获得xml文档的根节点
8 Element root = doc.getRootElement();
(2)如何遍历xml文档的所有结点
这样就读入了这个xml文档，并获得了这个xml文档对象的根结点，由于xml文档是一个树形结构，这样就很容易遍历它所有的结点了。
这里根据自己的需要，测试使用了两种遍历方法，一种是根据树的结构编写递归程序，一种就是直接使用循环，还有都dom4j自带的visitor模式访问也很好用，这里有篇参考文档，可以看看(查看)
使用递归遍历
public void visitAll(Element root, Element child){// 枚举所有子节点for ( Iterator i = root.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2009-03-12-gs-china/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2008-12-02-remotedesktop/">使用Code Blocks(mingw)IDE利用windows api编写远程桌面端口修改程序</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2008-12-02
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 7 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              办公室通过路由器上网，所以不能直接远程桌面登录到自己计算机上，办公室的人都想在宿舍登录到自己的计算机上工作学习，所以可以简单的将路由器的3389端口(windows远程桌面默认使用3389端口)映射到自己的IP上，同时修改其他人计算机的远程桌面端口，然后再相应的将路由器端口映射到自己的IP上即可。
修改远程桌面端口需要修改注册表中的两个值：
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp]
&ldquo;PortNumber&rdquo;=dword:00000d3d
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp]
&ldquo;PortNumber&rdquo;=dword:00000d3d
修改两个值，十进制是0-65535，双字十六进制是0x00000000-0x0000FFFF，推荐修改为1024以上。
如何使用windows api编写一个小程序来修改端口呢？接下来就详细的讲讲这个程序应该如何实现，另外在讨论一下如何使用windows api编写简单的windows程序。
下载开源的windows api集成开发环境Code::Blocks (访问Code::Blocks主页)
建议下载集成mingw的CodeBlocks，这样就不用单独下载安装mingw了，如果不知道什么是mingw，赶紧google一下看看吧。配置好开发环境后，就可以开始下一步啦。
启动Code::Blocks，然后新建一个Win32 GUI Project，这样IDE会自动构建一个对话框，而且程序的基本结构也就构造好了。程序的入口就是WinMain函数，然后就可以在这个基础之上编写我们的程序了。
先确定这个程序有几个窗口，然后修改resource.rc文件，资料都可以去MSDN查找
resource.rc
1#include &ldquo;resource.h&rdquo;
2
3DLG_MAIN DIALOGEX 6,6,269,131
4STYLE 0x90CC0800
5CAPTION &ldquo;远程桌面连接端口修改器&rdquo;
6FONT 8,&ldquo;MS Sans Serif&rdquo;,0,0
7BEGIN
8 CONTROL &ldquo;&quot;,IDC_EDT,&ldquo;Edit&rdquo;,0x50010000,72,51,170,13,0x00000200
9 CONTROL &ldquo;十进制(&amp;D)&quot;,IDC_RBN_D,&ldquo;Button&rdquo;,0x50010009,20,81,54,9
10 CONTROL &ldquo;十六进制(&amp;H)&quot;,IDC_RBN_H,&ldquo;Button&rdquo;,0x50010009,90,81,60,9
11 CONTROL &ldquo;二进制(&amp;B)&quot;,IDC_RBN_B,&ldquo;Button&rdquo;,0x50010009,164,81,54,9
12 CONTROL &ldquo;修改(&amp;E)&quot;,IDC_BTN_E,&ldquo;Button&rdquo;,0x50010000,14,107,54,13
13 CONTROL &ldquo;还原(&amp;B)&quot;,IDC_BTN_B,&ldquo;Button&rdquo;,0x50010000,70,107,54,13
14 CONTROL &ldquo;关于(&amp;A)&quot;,IDC_BTN_A,&ldquo;Button&rdquo;,0x50010000,126,107,54,13
15 CONTROL &ldquo;退出(&amp;Q)&quot;,IDC_BTN_Q,&ldquo;Button&rdquo;,0x50010000,198,107,54,13
16 CONTROL &ldquo;远程桌面端口&rdquo;,IDC_STC,&ldquo;Static&rdquo;,0x50000000,16,53,52,9
17 CONTROL &ldquo;基数&rdquo;,IDC_GRP,&ldquo;Button&rdquo;,0x50000007,14,70,228,24
18 CONTROL &ldquo;#1013&rdquo;,IDC_IMG,&ldquo;Static&rdquo;,0x5000020E,0,0,271,44
19END
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2008-12-02-remotedesktop/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2008-09-03-226778/">windows xp sp3 + apache_2.2.8-win32-x86-openssl-0.9.8g.msi + php-5.2.5-Win32.zip + mysql-5.0.45-win32.exe的安装记录</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2008-09-03
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              在windows下安装过很多次apache+php+mysql了，每次都没有做一个详细的记录。今天心情不好，所以写个日志。
这里的安装方法都是参考于php的官方安装文档，所以直接查看它的官方文档就可以安装了
主要参考这两个手册：php-5中文手册和php-5.2.5-Win32.zip 软件包中的install.txt
首先请准备以下软件(ps：我的这些软件都是很久前下载的，现在已经有新版本了，不过安装方法都是一样的)
点击下载apache
点击下载php-5
点击下载mysql
下面开始安装(安装顺序无所谓)和配置，不要一味的照搬，自己结合自己的情况看看
===&gt; 软件的安装
1)安装apache_2.2.8-win32-x86-openssl-0.9.8g.msi
=&gt;安装方法：直接运行安装程序安装
2）安装php-5
=&gt; 解压下载的安装包，将解压后的文件目录名改为php，以方便后面的配置
=&gt;进入刚刚改名为php的目录，找到php.ini-recommended文件，将该文件改名为php.ini
=&gt;将名为php的目录整个拷贝了任意一个盘(c，d……)的根目录下，以方便后面的配置,我将php整个目录拷贝到了D盘根目录下，即d:\php
3）安装mysql
=&gt;安装方法：直接运行安装程序安装
=&gt;配置mysql：安装完mysql后，程序会自动弹出配置窗口，直接点击&quot;next&quot;&hellip;&hellip;.，然后设置好相应的字符编码和root用户的密码等
这样程序就安装完成了，下面分析这些软件应该如何配置才能工作。
===&gt; 服务器的配置(这里只是简单讲讲如何让服务器正常工作，想要知道更多的配置，请自行查看软件配置文档)
1）配置php(先前我将解压后的php包整个拷贝到了d目录下d:\php)
=&gt;进入php所在目录，目录结构基本是这个样子
点击展开
d:\php
|
+&ndash;dev
| |
| |-php5ts.lib
|
+&ndash;ext &ndash; extension DLLs for PHP
| |
| |-php_bz2.dll
| |
| |-php_cpdf.dll
| |
| |-..
|
+&ndash;extras
| |
| +&ndash;mibs &ndash; support files for SNMP
| |
| +&ndash;openssl &ndash; support files for Openssl
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2008-09-03-226778/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2008-09-02-226416/">使用正则表达式来限制输入框中只能输入数字</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2008-09-02
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2008-09-02-226416/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2008-05-06-template-canvas/">也扯打造个性BlogJava模板</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2008-05-06
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2008-05-06-template-canvas/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2008-05-06-jni-free-ictclas/">打造ICTCLAS JNI For Java</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2008-05-06
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 2 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              声明:ICTCLAS以及我修改ICTCLAS JNI For Java的版权均归原作者所有，未经原作者允许，请勿作其它商业用途
首先下载ICTCLAS Beta版本公开源代码:点击下载
我使用的是Visual studio 2005开发环境，源码使用VC6开发的，现在把这个工程转移到VS2005下。我使用的方法比较笨，基本上是属于体力+暴力型的，不过自己觉得爽就可以了
在VS2005里新建Win32项目FREEICTCLAS,在application Settings选项里选中Dll和Empty Project,然后新建以下过滤器(New Filter)，并且将原项目的源码及其目录结构copy到现在的win32项目的目录下(过滤器和项目目录示意图)
示意图(点击前面+号展开)
| |
这样这个win32工程基本就建完了。
观察ICTCLAS源代码后编写以下带有native声明的方法的java类，只实现了头两个方法，第三个暂未实现，与ICTCLAS接口基本保持一致
代码如下:
FreeICTCLAS.java(点击+展开)
public class FreeICTCLAS
{
///*
* 初始化设置取值都是0,1,2
*/
public native boolean FreeICTCLAS_Init(int OperateType, int OutputFormat);
///*
* 与Free版本中有所不同,返回值为结果
/
public native String FreeICTCLAS_ParagraphProcess(String sParagraph);
/**//
* 与Free版本中基本保持一致
*/
public native boolean FreeICTCLAS_FileProcess(String sSourceFilename, String sResultFilename);
public static void main(String[] args)
{
System.loadLibrary(&ldquo;FreeICTCLAS&rdquo;);
FreeICTCLAS test = new FreeICTCLAS();
test.FreeICTCLAS_Init(0,0);
String str = test.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2008-05-06-jni-free-ictclas/"
              >Read more →</a
            >
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title"><a href="https://lewang.dev/posts/2008-05-05-jni-hello-world/">JNI技术入门之Hello World篇</a></h1>
        <div class="post-meta">
          
            <time class="post-date">
              2008-05-05
            </time>

            
              



            
          
          
            <span class="post-author"
              >— Written by Le</span
            >


          
            <span class="post-read-time"
              >— 1 min read</span
            >
          
        </div>

        
          <span class="post-tags">
            
              <a href="https://lewang.dev/tags/blogjava/">#blogjava</a>&nbsp;
            
          </span>
        

        

        <div class="post-content">
          
            
              毕业设计是做一个中文的XML信息检索系统。当时选题的时候真的是不知道天高地厚，选了这么一个难题，但是毕竟已经选了，那就不要畏缩了！查阅了信息检索的相关资料后，遇到了一个很棘手的问题——中文如何分词？这是个大问题，不知道如何入手。于是查查资料看看有没有现成中文分词系统拿来用，这一找就找到了中科院的ICTCLAS。网上已经有很多的已经封装好了的ICTCLAS.dll，由于毕设打算用Java技术打造一个系统原型，那就需要通过JNI技术来调用ICTCLAS.dll。其实这也已经有人做好了，但是，我还是想知道JNI的个什么样的东西，还想知道如何正确的使用这个技术。
已经习惯了从Hello World开始。
我使用的是JDK_1.6.0和Visual studio 2005，使用Visual studio 2005生成可供Java调用的dll需要做以下设置：
在Visual studio 2005的菜单Tools\options\Projects and Solutions\VC++ Directories，添加JDK安装目录下inlcude和include/win32目录,如下图所示
设置图(点击前面+号展开)
编写带有native声明的方法的java类，代码如下
JniTest.java(点击前面+号展开)
public class JniTest{/*静态块装载JniTest.dll，不用写出后缀名.dll,因为不同平台，系统会自动识别*/static {System.loadLibrary(&quot;JniTest&quot;);}/*native方法申明,不要写具体的实现*/public native void sayHello();}然后在命令行输入Javac JniTest.java编译JniTest.java
生成JniTest.class文件后，再使用javah JniTest生成JniTest.h，代码如下
JniTest.h(点击前面+号展开)
/* DO NOT EDIT THIS FILE - it is machine generated */#include &lt;jni.h&gt;/* Header for class JniTest */#ifndef _Included_JniTest#define _Included_JniTest#ifdef __cplusplusextern &quot;C&quot; {#endif/** Class: JniTest* Method: sayHello* Signature: ()V*/JNIEXPORT void JNICALL Java_JniTest_sayHello(JNIEnv *, jobject);#ifdef __cplusplus}#endif#endif在Visual studio 2005里新建项目Win32 project，在弹出的对话框中点击application setting，然后再选上dll和Empty project。 接着在项目中添加JniTest.
            
          
        </div>
        
          <div>
            <a class="read-more button" href="/posts/2008-05-05-jni-hello-world/"
              >Read more →</a
            >
          </div>
        
      </article>
    
    <div class="pagination">
  <div class="pagination__buttons">
    
      <span class="button previous">
        <a href="/posts/page/4/">
          <span class="button__icon">←</span>
          <span class="button__text">Newer posts</span>
        </a>
      </span>
    
    
      <span class="button next">
        <a href="/posts/page/6/">
          <span class="button__text">Older posts</span>
          <span class="button__icon">→</span>
        </a>
      </span>
    
  </div>
</div>

  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="https://lewang.dev"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >小碼哥</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span>© 2023 Powered by <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span>
        <span><a href="https://github.com/panr/hugo-theme-hello-friend" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
    
  </div>
</footer>





<script type="text/javascript" src="/bundle.min.js"></script>


      
    </div>

    
      
<script async src="https://www.googletagmanager.com/gtag/js?id=G-12QS222X0Z"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-12QS222X0Z', { 'anonymize_ip': false });
}
</script>

    
  </body>
</html>
